<div class="w-full mx-auto px-4 sm:px-6 lg:px-8">
  <!-- header -->
  <div class="pt-8">
    <button (click)="back()" class="inline-flex items-center gap-2 text-gray-300 hover:text-white">
      <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
      Назад
    </button>
    <h1 class="mt-2 text-3xl font-bold">Создание проекта</h1>
    <p class="text-sm text-gray-400">Создайте новый проект и подключите Git-репозиторий</p>
  </div>

  <!-- card -->
  <section class="mt-6 max-w-screen-lg xl:max-w-screen-xl">
    <div class="rounded-xl border border-white/10 bg-white/[0.03] p-6"
         style="box-shadow:0 0 0 1px rgba(255,255,255,.02) inset">
      <h2 class="text-xl font-semibold">Создание нового проекта</h2>
      <p class="text-sm text-gray-400">Заполните основную информацию о проекте</p>

      <!-- STEP 1: info -->
      @if (step === 1) {
        <form class="mt-4 space-y-4" [formGroup]="form">
          <div>
            <label class="text-sm text-gray-300">Название проекта *</label>
            <input formControlName="name"
                   class="mt-1 w-full h-11 rounded-md border border-white/10 bg-white/5 px-3 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-white/20"
                   placeholder="Введите название проекта"/>
            @if (form.get('name')?.invalid && form.get('name')?.touched) {
              <div class="mt-1 text-xs text-rose-300">Минимум 3 символа</div>
            }
          </div>

          <div>
            <label class="text-sm text-gray-300">Описание *</label>
            <textarea formControlName="description"
                      class="mt-1 w-full min-h-[120px] rounded-md border border-white/10 bg-white/5 px-3 py-2 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-white/20"
                      placeholder="Опишите назначение проекта"></textarea>
            @if (form.get('description')?.invalid && form.get('description')?.touched) {
              <div class="mt-1 text-xs text-rose-300">Минимум 10 символов</div>
            }
          </div>

          <div class="flex items-center gap-3 pt-2">
            <button type="button" class="h-10 px-4 rounded-md border border-white/10 bg-white/5 text-sm" (click)="back()">Отмена</button>
            <button type="button" class="h-10 px-4 rounded-md bg-blue-600/90 hover:bg-blue-600 text-white text-sm font-medium"
                    [disabled]="!canContinue1()" (click)="next()">Продолжить</button>
          </div>
        </form>
      }

      <!-- STEP 2: provider + repo -->
      @if (step === 2) {
        <div class="mt-4">
          <h3 class="text-lg font-semibold">Git-репозиторий</h3>
          <p class="text-sm text-gray-400">Подключите Git-репозиторий для автоматизации процессов</p>

          <!-- providers -->
          <div class="mt-4 grid grid-cols-1 sm:grid-cols-3 gap-4">
            <button type="button" (click)="setProvider('github')"
              class="h-24 rounded-lg border px-4 text-left hover:bg-white/[0.06]"
              [class.border-white/30]="provider==='github'" [class.bg-white/10]="provider==='github'"
              [class.border]="true" [class.border-white/10]="provider!=='github'">
              <div class="flex items-center gap-3">
                <div class="h-10 w-10 rounded-md bg-[#0f172a] grid place-items-center">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .5a12 12 0 0 0-3.79 23.4c.6.11.82-.26.82-.58v-2.02c-3.34.73-4.04-1.61-4.04-1.61-.55-1.4-1.34-1.77-1.34-1.77-1.09-.74.08-.73.08-.73 1.2.08 1.83 1.23 1.83 1.23 1.07 1.83 2.81 1.3 3.5.99.11-.78.42-1.3.76-1.6-2.67-.31-5.47-1.34-5.47-5.96 0-1.32.47-2.4 1.24-3.25-.12-.3-.54-1.55.12-3.22 0 0 1.01-.32 3.3 1.24a11.5 11.5 0 0 1 6 0c2.29-1.56 3.3-1.24 3.3-1.24.66 1.67.24 2.92.12 3.22.77.85 1.24 1.93 1.24 3.25 0 4.63-2.81 5.64-5.49 5.95.43.37.81 1.1.81 2.22v3.29c0 .32.21.7.82.58A12 12 0 0 0 12 .5z"/></svg>
                </div>
                <div>
                  <div class="font-medium">GitHub</div>
                  <div class="text-xs text-gray-400">Рекомендовано</div>
                </div>
              </div>
            </button>

            <button type="button" (click)="setProvider('gitlab')"
              class="h-24 rounded-lg border px-4 text-left hover:bg-white/[0.06]"
              [class.border-white/30]="provider==='gitlab'" [class.bg-white/10]="provider==='gitlab'"
              [class.border]="true" [class.border-white/10]="provider!=='gitlab'">
              <div class="flex items-center gap-3">
                <div class="h-10 w-10 rounded-md bg-[#1f2937] grid place-items-center">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3.5 2l3 8.5h11L20.5 2 12 20 3.5 2z"/></svg>
                </div>
                <div><div class="font-medium">GitLab</div></div>
              </div>
            </button>

            <button type="button" (click)="setProvider('bitbucket')"
              class="h-24 rounded-lg border px-4 text-left hover:bg-white/[0.06]"
              [class.border-white/30]="provider==='bitbucket'" [class.bg-white/10]="provider==='bitbucket'"
              [class.border]="true" [class.border-white/10]="provider!=='bitbucket'">
              <div class="flex items-center gap-3">
                <div class="h-10 w-10 rounded-md bg-[#0c2a66] grid place-items-center">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 3h18l-2.4 14.5H5.4L3 3zm5.6 5h6.8l-.8 5H9.4l-.8-5z"/></svg>
                </div>
                <div><div class="font-medium">Bitbucket</div></div>
              </div>
            </button>
          </div>

          <!-- optional repo fields -->
          <form class="mt-6 space-y-4" [formGroup]="repoGroup">
            <div>
              <label class="text-sm text-gray-300">URL репозитория (опционально)</label>
              <input formControlName="url" class="mt-1 w-full h-11 rounded-md border border-white/10 bg-white/5 px-3 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-white/20"
                     placeholder="https://github.com/company/project"/>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="text-sm text-gray-300">Ветка</label>
                <input formControlName="branch" class="mt-1 w-full h-11 rounded-md border border-white/10 bg-white/5 px-3 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-white/20"/>
              </div>
              <div>
                <label class="text-sm text-gray-300">Токен доступа (опционально)</label>
                <input type="password" formControlName="token" class="mt-1 w-full h-11 rounded-md border border-white/10 bg-white/5 px-3 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-white/20"
                       placeholder="ghp_xxxxx"/>
              </div>
            </div>
          </form>

          <div class="flex items-center gap-3 pt-2">
            <button type="button" class="h-10 px-4 rounded-md border border-white/10 bg-white/5 text-sm" (click)="back()">Назад</button>
            <button type="button" class="h-10 px-4 rounded-md bg-blue-600/90 hover:bg-blue-600 text-white text-sm font-medium"
                    [disabled]="!canContinue2()" (click)="next()">Продолжить</button>
          </div>
        </div>
      }

      <!-- STEP 3: summary -->
      @if (step === 3) {
        <div class="mt-4 space-y-4">
          <h3 class="text-lg font-semibold">Подтверждение</h3>
          <div class="text-sm text-gray-300">Название: <span class="text-white">{{ form.value.name }}</span></div>
          <div class="text-sm text-gray-300">Описание: <span class="text-white">{{ form.value.description }}</span></div>
          <div class="text-sm text-gray-300">Провайдер: <span class="text-white">{{ provider || '—' }}</span></div>

          <div class="flex items-center gap-3 pt-2">
            <button type="button" class="h-10 px-4 rounded-md border border-white/10 bg-white/5 text-sm" (click)="back()">Назад</button>
            <button type="button" class="h-10 px-4 rounded-md bg-blue-600/90 hover:bg-blue-600 text-white text-sm font-medium"
                    (click)="submit()">Создать проект</button>
          </div>
        </div>
      }
    </div>
  </section>
</div>
